# SoChi BLOCKS — DB Layer Overview

下表は **パズル DB レイヤ構造** の概要です。マスタ‐ベース‐バリアントの 3 層に分けて整理しています。

| レイヤ                        | テーブル候補                          | 格納内容                                                        | 実装イメージ                              |
| -------------------------- | ------------------------------- | ----------------------------------------------------------- | ----------------------------------- |
| **ピースマスタ**                 | `master_piece`                  | `id = 'F', 'I', …`<br>`shape_json = [[x,y,z]...]`（原点基準セル配列） | `PIECE_DEF` を静的に移植<br>※追加で色・難度フラグも可 |
| **完成形ベース**<br>（3×4×5 完全充填） | `master_base_puzzle`（既存定義）      | `name = "3×4×5 full"`                                       | 1 件だけ登録                             |
| **ベース内セル**                 | `master_base_puzzle_cell`（既存定義） | `value = piece_id`                                          | 60 行（F〜Z…）                          |
| **Variant**（ピース欠損版）        | `content_puzzle`（既存定義）          | `base_puzzle_id` = 上記ベース                                    | “F と N を引いた 10 ピース版” など             |
| **Variant 内セル**            | `content_puzzle_cell`（既存定義）     | 欠損を反映したセルのみ格納                                               | ピースを間引いて INSERT                     |

> **Note:** 将来的に Variant 生成ロジックは Python スクリプト側で、ピース欠損・回転／反転を含め柔軟に拡張予定です。
